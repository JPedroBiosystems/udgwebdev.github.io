<!DOCTYPE html><html lang="en" manifest="/manifest.appcache" xmlns="http://www.w3.org/1999/xhtml" xmlns:og="http://ogp.me/ns#"><head><meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/><meta charset="utf-8"/><title>Node.js para leigos - Child process | Underground WebDev</title><meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#BA2D27"/><meta name="apple-mobile-web-app-title" content="UDGWebDev"/><meta name="msapplication-TileImage" content="https://udgwebdev.com/images/undefined-128.png"/><meta name="msapplication-TileColor" content="#BA2D27"/><meta name="msapplication-tap-highlight" content="no"/><meta name="mobile-web-app-capable" content="yes"/><meta name="application-name" content="UDGWebDev"/><meta name="theme-color" content="#BA2D27"/><meta name="title" content="Node.js para leigos - Child process"/><meta name="author" content="Caio Ribeiro Pereira"/><meta name="description" content="No node.js a manipulação de processos do sistema operacional é fácil de aprender e sua utilização é de extrema importância. Neste post falarei como trabalhar com child process."/><meta property="og:title" content="Node.js para leigos - Child process"/><meta property="og:description" content="No node.js a manipulação de processos do sistema operacional é fácil de aprender e sua utilização é de extrema importância. Neste post falarei como trabalhar com child process."/><meta property="og:url" content="https://udgwebdev.com/node-js-para-leigos-child-process"/><meta property="og:site_name" content="Underground WebDev"/><meta property="og:image" content="https://udgwebdev.com/images/udgwebdev-logo.png"/><meta property="og:type" content="website"/><meta property="article:author" content="https://plus.google.com/+CaioRibeiroPereira"/><meta property="article:section" content="main"/><meta name="twitter:creator" content="@crp_underground"/><meta name="twitter:card" content="summary"/><meta name="twitter:url" content="https://udgwebdev.com/node-js-para-leigos-child-process"/><meta name="twitter:title" content="Node.js para leigos - Child process"/><meta name="twitter:description" content="No node.js a manipulação de processos do sistema operacional é fácil de aprender e sua utilização é de extrema importância. Neste post falarei como trabalhar com child process."/><meta name="twitter:image" content="https://udgwebdev.com/images/udgwebdev-logo.png"/><link rel="manifest" href="/manifest.json"/><link rel="stylesheet" href="/assets/css/main.css" type="text/css"/><link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"/><link rel="canonical" href="https://udgwebdev.com/node-js-para-leigos-child-process"/></head><body><nav role="navigation" class="navbar navbar-inverse navbar-fixed-top"><div class="container"><div class="navbar-header"><button type="button" class="navbar-toggle collapsed"><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><a href="/" class="navbar-brand"><img src="/images/udgwebdev-logo.png" alt="Underground WebDev" width="48" class="navbar-logo"/></a></div><div class="navbar-right navbar-collapse collapse"><ul class="nav navbar-nav"><li><a href="/nodejs"><i class="fa fa-code"></i>&nbsp;Node.js</a></li><li><a href="/meteor"><i class="fa fa-code"></i>&nbsp;Meteor</a></li><li><a href="/dicas-de-terminal"><i class="fa fa-terminal"></i>&nbsp;Terminal</a></li></ul></div></div></nav><nav role="navigation" class="c-circle-menu js-menu"><button class="c-circle-menu__toggle js-menu-toggle"><span>Toggle</span></button><ul class="c-circle-menu__items"><li class="c-circle-menu__item"><a href="http://feeds.feedburner.com/UndergroundWebDev" target="_blank" rel="nofollow" title="Feed" class="c-circle-menu__link"><i class="icon fa fa-rss"></i></a></li><li class="c-circle-menu__item"><a href="https://github.com/caio-ribeiro-pereira" target="_blank" rel="nofollow" title="Github" class="c-circle-menu__link"><i class="icon fa fa-github"></i></a></li><li class="c-circle-menu__item"><a href="https://www.facebook.com/udgwebdev" target="_blank" rel="nofollow" title="Fanpage" class="c-circle-menu__link"><i class="icon fa fa-facebook-square"></i></a></li><li class="c-circle-menu__item"><a href="http://twitter.com/crp_underground" target="_blank" rel="nofollow" title="Twitter" class="c-circle-menu__link"><i class="icon fa fa-twitter-square"></i></a></li><li class="c-circle-menu__item"><a href="https://www.linkedin.com/in/caioribeiropereira" target="_blank" rel="nofollow" title="LinkedIn" class="c-circle-menu__link"><i class="icon fa fa-linkedin-square"></i></a></li></ul><div class="c-circle-menu__mask js-menu-mask"></div></nav><main role="main" class="container vertical-centralization"><div class="row"><article id="node-js-para-leigos-child-process" class="col-xs-12 col-sm-9 post"><h1>Node.js para leigos - Child process</h1><p class="text-muted">Publicação: <time datetime="01/11/2012" pubdate><b>01/11/2012</b></time> | Tags: <a href="/menu/#node.js" rel="me" title="Menu: Node.js">Node.js</a></p><p><img src="/images/nodejs-para-leigos.jpg" alt="Curso de Node.js" title="Curso de Node.js"></p>
<p>Hoje estudaremos um assunto muito interessante em que no Node.js sua manipulação é simples de aprender e sua utilização é de extrema importância. Falarei sobre manipulação de processos do sistema operacional, através da API nativa chamada: <strong>Child Process</strong>.</p>
<p>Primeiramente, quando utilizar Child Process?
Quando há a necessidade de utilizar programas ou comandos nativos do sistema operacional. Ao executar um programa, é criado um processo sobre esse programa, e todo processo é gerenciado pelo sistema operacional.</p>
<p>Exemplos de manipulação de processos: <strong>executar um processo, executar processo em background, matar um processo, priorizar a execução de processos e muito mais.</strong> Todo sistema operacional traz essas funcionalidades para gerenciá-lo, assim como a maioria das linguagens de programação possuem bibliotecas para manipulação do mesmo.</p>
<p>Com o Node.js é possível fazer o mesmo e também manipular processos filhos <strong>(Child Process)</strong> que são processos que compartilham memória com o processo pai, que no caso o processo pai sempre será a sua aplicação Node.js.</p>
<p>Na prática, compartilhar memória entre processos seria basicamente compartilhar variáveis entre os processos, fazendo com que ambos trabalhem e manipulem elas. Child Process é uma biblioteca nativa do Node.js, e sua <a href="http://nodejs.org/api/child_process.html" title="Documentação Child Process no Node.js">documentação completa esta aqui.</a> Veja alguns exemplos práticos do que fazer com ele:</p>
<h4>Utilizando comandos Exec</h4><pre><code class="language-javascript"> var exec = require(&#39;child_process&#39;).exec;
 exec(&#39;pwd&#39;, function(error, stdout, stderr){
   console.log(stdout);
 });
</code></pre>
<p>Para quem não sabe, o <strong>comando pwd é exclusivo dos sistemas UNIX</strong>, e ele apenas informa o diretório atual que o usuário esta acessando. Repare também que a função callback do comando exec, retorna obrigatoriamente 3 variáveis: <strong>error, stdout e stderr</strong>. Respetivamente elas significam: <strong>erro de execução (lança uma exceção), mensagem de saída, mensagem de erro.</strong></p>
<h4>Spawn de processos</h4><pre><code class="language-javascript"> var spawn = require(&#39;child_process&#39;).spawn
   , pwd = spawn(&#39;pwd&#39;);
 pwd.stdout.setEncoding(&#39;utf8&#39;);
 pwd.stdout.on(&#39;data&#39;, function(data){
   console.log(data);
 });
</code></pre>
<p>Neste exemplo, executamos o mesmo comando, porém fazendo um spawn de processos. A grande diferença entre <strong>exec e spawn</strong>, é que o exec faz uma execução simples e o spawn possui funções e eventos mais completos para realizar uma execução complexa de processos. É necessário informar o encoding no método <strong>setEncoding()</strong> para a variável <strong>data</strong> retornar uma String, <strong>senão será retornado um objeto Buffer</strong>. Outro detalhe é que o spawn possui as funções: <strong>stdout, stderr, stdin, kill e pid</strong>.</p>
<ul>
<li><code>stdout:</code> trata a saída da execução do processo;</li>
<li><code>stderr:</code> trata a saída de erro na execução do processo;</li>
<li><code>stdin:</code> trata a entrada de dados na execução do processo;</li>
<li><code>pid:</code> retorna o PID, ID do processo no sistema operacional;</li>
<li><code>kill:</code> mata o processo atual;</li>
</ul>
<p>Todas elas funcionam através dos eventos: <strong>on(‘data’), on(‘exit’), on(‘disconnect’) e on(‘close’)</strong>.Um bom exemplo de saída de processos é o comando do código abaixo:</p>
<pre><code class="language-javascript"> pwd.stdout.on(&#39;data&#39;, function(data){
   console.log(data)
 });
</code></pre>
<p>Com isso, podemos cria aplicações que utilizem programas ou comandos do sistema operacional. Para finalizar, mostrarei uma simples aplicação de logger em tempo real, que basicamente faz um spawn de processos, executando o comando <strong>tail -f</strong> de um arquivo de logs gerado por uma outra aplicação.</p>
<p>Obs.: Este aplicativo só funciona em <strong>ambiente UNIX, Linux ou MacOSX</strong>, visto que o comando tail é específico desses sistemas operacionais.</p>
<p>Para executar esse código, execute primeiro o comando:</p>
<p><code>npm install express</code></p>
<pre><code class="language-javascript"> // app.js
 var express = require(&#39;express&#39;)
   , fs = require(&#39;fs&#39;)
   , app = express()
   , logFile = fs.createWriteStream(&#39;./app.log&#39;, {flags: &#39;a&#39;});
 app.configure(function(){
   app.use(express.logger({stream: logFile}));
   app.use(express.methodOverride());
   app.use(app.router);
 });
 app.get(&#39;/&#39;, function(req, res){
   res.end(&quot;Hello World&quot;);
 });
 app.listen(3000, function(){
   console.log(&#39;Hello world running...&#39;);
 });
</code></pre>
<pre><code class="language-javascript"> // log.js
 var spawn = require(&#39;child_process&#39;).spawn
   , tail = spawn(&#39;tail&#39;, [&#39;-f&#39;, &#39;./app.log&#39;]);
 tail.stdout.setEncoding(&#39;utf8&#39;);
 tail.stdout.on(&#39;data&#39;, function(data){
   console.log(data);
 });
</code></pre>
<p>Abra dois consoles: um para executar o comando a aplicação web: <code>node app.js)</code> e no outro inicie a aplicação de logger: <code>node log.js</code>.</p>
<p>Ao acessar a aplicação web através do endereço: <strong><a href="http://localhost:3000">http://localhost:3000</a></strong> verifique no console da aplicação de logger as atualizações na tela com mensagens de logging da aplicação web que foi acessada.</p>
<p>É isso ae pessoal! Esse foi mais um capitúlo da série node.js para leigos, dúvidas, sugestões ou críticas comentem abaixo. Até a próxima!</p><div id="disqus_thread"></div><script async="async" defer="defer">(function() {
  var disqus_shortname = 'udgwebdev';
  var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
  dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><noscript>Por favor, habilite o JavaScript no seu browser para visualizar os comentários deste post.</noscript><script type="application/ld+json">{
  "@context": "http://schema.org",
  "@type": "BlogPosting",
  "headline": "Node.js para leigos - Child process",
  "image": "https://udgwebdev.com/images/udgwebdev-logo.png",
  "publisher": "Underground WebDev",
  "url": "https://udgwebdev.com/node-js-para-leigos-child-process",
  "datePublished": "2012-11-01",
  "dateCreated": "2012-11-01",
  "description": "No node.js a manipulação de processos do sistema operacional é fácil de aprender e sua utilização é de extrema importância. Neste post falarei como trabalhar com child process.",
  "author": {
    "@type": "Person",
    "name": "Caio Ribeiro Pereira"
  }
}</script></article></div></main><footer class="footer text-center"><p><small><i class="fa fa-trophy"></i>&nbsp;Powered by <a href="https://pages.github.com" rel="nofollow" target="_blank" title="Github Pages">Github Pages</a>, <a href="http://gruntjs.com" rel="nofollow" target="_blank" title="Grunt">Grunt</a> and <a href="http://harpjs.com" rel="nofollow" target="_blank" title="Harp.js">Harp.js</a>.</small><br/><small>Autor: <a href="https://crpwebdev.github.io" rel="me" target="_blank" title="Caio Ribeiro Pereira">Caio Ribeiro Pereira</a>.</small></p></footer><script src="/assets/js/circlemenu.min.js"></script><script src="/assets/js/main.js"></script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-25728091-2', 'auto');
ga('send', 'pageview');</script></body></html>