---
layout: post
title: Dicas de segurança para aplicações Meteor
tags: Meteor
keywords: Meteor, Segurança no Meteor, NoSQL Injection
published: true
description: Se você esta desenvolvendo uma aplicação Meteor, é importante estar por dentro de como garantir segurança em sua aplicação. Nesse post mostrarei algumas dicas simples e de fácil execução para blindar seu projeto!
image_url: meteor-logo.jpg
---
<figure class="post-image">
  <img src="{{ site.url }}/images/meteor-logo.jpg" width="250" height="72" alt="Meteor" title="Meteor">
</figure>
<div class="post-content">
  <p>Se você esta desenvolvendo uma aplicação Meteor, é importante estar por dentro de como garantir segurança em sua aplicação. Nesse post mostrarei algumas dicas simples e de fácil execução para blindar seu projeto.</p>

  <h2>Remova o insecure e autopublish</h2>
  <p>Antes de você colocar seu app em produção, execute esse comando:</p>

{% highlight bash %}
meteor remove insecure autopublish
{% endhighlight %}

  <p>E faça um refactoring em seu app para garantir que todas as funcionalidades de PubSub estão funcionando e certifique-se também que todas as funções de escrita das collections que são realizadas no client-side funcionem através da função Meteor.call (client-side) /Meteor.methods (server-side). Se possível, toda vez que você começar um novo projeto Meteor, que comece-o removendo esses 2 packages, para que você não tenha retrabalho no futuro. O motivo do Meteor utilizar esses packages é que eles agilizam a produtividade na prototipação, porém usar eles em produção libera uma brecha de segurança que permite pelo console de um browser executar qualquer manipulação nas collections do MongoDB. Se estiver com dúvidas sobre trabalhar com PubSub ou Meteor.methods, leia esses post: <a href="{{ site.url }}/meteor-pubsub" target="_blank" title="Meteor PubSub" rel="me">Meteor PubSub</a> e <a href="{{ site.url }}/meteor-methods" target="_blank" title="Meteor.methods" rel="me">Meteor.methods</a>.</p>

  <h2>Evitando NoSQL Injection</h2>

  <p>Para evitar possíveis ataques de <strong>NoSQL Injection</strong>, instale o package <a href="https://atmospherejs.com/meteor/audit-argument-checks" target="_blank">audit-argument-checks</a>:</p>

{% highlight bash %}
meteor add audit-argument-checks
{% endhighlight %}

  <p>Sempre execute a função <strong>check()</strong> para validar o tipo de dados de todos os parâmetros existentes numa função <strong>Meteor.publish()</strong> ou <strong>Meteor.methods()</strong>.<br>
  Para demonstrar um exemplo simples de NoSQL Injection veja o código abaixo:</p>

{% highlight javascript %}
// No client-side posso enviar esse parâmetro...
Meteor.subscribe("clients", {$gte: ""});

// Sem a função check() validando se "name" é uma string, os resultados teriam sidos manipulados sem alertar erro...
Meteor.publish("clients", function(name) {
  check(name, String);
  return Clients.find({
    name: name
  });
});
{% endhighlight %}

  {% include content-ads.ext %}

  <h2>Configure corretamente o App.accessRule</h2>

  <p>Se sua aplicação Meteor for um app mobile é recomendável que você configure corretamente quais urls externas sua aplicação poderá acessar, para evitar por exemplo que seus usuários acessem acidentalmente uma url maliciosa. Para configurar isso, acesse o arquivo <strong>mobile-config.js</strong> e inclua todas as urls externas que seu app poderá acessar:</p>

{% highlight javascript %}
App.accessRule("*.myurl.com/*");
App.accessRule("*.anotherurl.com/*");
App.accessRule("tel://*", {launchExternal: true});
{% endhighlight %}

  <p>Respectivamente esses 3 padrões permitem que seu app possa consumir recursos desses endereços, em especial o último padrão, permite abrir um aplicativo externo para executar a url scheme <strong>tel://*</strong> (que é uma url scheme para informar número de telefones). Evite sempre informar isso:</p>

{% highlight javascript %}
App.accessRule("*");
{% endhighlight %}

  <p>Esse padrão permite que seu app acesse qualquer url e qualquer url scheme, e consequentemente isso pode gerar possíveis brechas de segurança em seu app.<br>
  Hey! Esse post tem continuação: <a href="{{site.url}}/dicas-de-seguranca-para-aplicacoes-meteor-parte-2" rel="me">Dicas de segurança para aplicações Meteor - Parte 2</a>.</p>

  <p><strong>Fonte:</strong> <a href="http://www.1pxsolidtomato.com/2015/04/06/nosql-injection-or-always-check-your-arguments/" target="_blank">NoSQL Injection - Or, Always Check Your Arguments!</a></p>
</div>
