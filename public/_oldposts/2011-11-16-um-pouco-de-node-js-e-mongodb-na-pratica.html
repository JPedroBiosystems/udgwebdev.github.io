---
layout: post
title: Node.js e MongoDB na prática!
keywords: Node.js, MongoDB, MongoQ, Express, Javascript
tags:
- Node.js
- NoSQL
description: Aplicando meus conhecimentos sobre Node.js busquei aprender um pouco mais sobre bancos NoSQL e a recomendação que me veio foi de estudar o MongoDB.
published: true
---
<figure class="post-image">
   <img src="{{ site.url }}/images/nodejs-e-mongodb.jpg" width="250" height="142" alt="Node.js e MongoDB na prática!" title="Node.js e MongoDB na prática!">
   <figcaption>Um pouco de MongoDB com Node.js</figcaption>
</figure>
<div class="post-content">
   <p>Recentemente fiz uma mini-aplicação no meu trabalho, e resolvi aplicar na prática meus conhecimentos sobre <strong>Node.js</strong>. Com isso apenas precisava escolher um banco de dados que fosse tão simples e fácil quanto a própria linguagem da aplicação. Na verdade eu estava em busca de aprender um pouco sobre bancos <strong>NoSQL</strong> e a recomendação que me veio foi sobre o <strong>MongoDB</strong>.</p>

   {% include content-ads.ext %}
   
   <p>Na wiki oficial sobre módulos do Node.js <a href="https://github.com/joyent/node/wiki/modules" title="Node.js wiki módulos" target="_blank" rel="no-follow">https://github.com/joyent/node/wiki/modules</a> existem cerca de 1100 módulos para Node.js e existem 15 módulos para <strong>MongoDB</strong> com <strong>Node.js</strong>.</p>
   <p>Desses 15 módulos apenas testei 4 pelo qual 3 deles fiquei meio perdido por falta de uma clara documentação e o módulo que tive mais afinidade e facilidade em usar foi o <a href="https://github.com/zzdhidden/mongoq" title="Github do Mongoq" target="_blank" rel="no-follow">mongoq</a>, inclusive até conheci o autor desse módulo, um chinês muito gente boa que me ajudou, ensinando as boas práticas do seu módulo.</p>
   <p>Abaixo irei explicar um pouco de código para criar um mini-aplicativo de cadastro de usuários. Lembrando que utilizarei também o <a href="http://expressjs.com/" title="Express" target="_blank" rel="no-follow">Express</a> que permitie criar as rotas da aplicação, pois o código abaixo apenas apresentarei como fazer um simples <strong>controller</strong> criando as rotas e explorando as funcionalidades do <strong>MongoQ</strong>, mas não entrarei em detalhes sobre o <strong>Express</strong>, pois não é o objetivo desse post.</p>
   <p>Primeiro, para começarmos a brincadeira, instale os seguintes módulos:</p>
{% highlight bash %}
npm install express mongoq
{% endhighlight %}
   <p>Agora crie o arquivo <strong>app.js</strong> e mãos a obra!</p>
{% highlight javascript %}
// Instanciando os módulos Express e Mongoq
var express = require('express');
var mongoq = require('mongoq');

// Configurando a execução do banco MongoDB
var COLLECTION = 'collection_teste';
var DB = 'banco_teste';
var db = mongoq(DB);
var collection = db.collection(COLLECTION);

// Iniciando o servidor Express
var app = module.exports = express.createServer();
// Configuração básica do servidor Express
app.configure(function(){
   app.use(express.bodyParser());
   app.use(express.methodOverride());
   app.use(app.router);
});

// Rota GET para listar os usuários
app.get('/usuarios', function(req, res){
   // Fazendo uma consulta no banco de dados
   collection.find().toArray(function(err, result){
      res.render('index', { usuarios : result });
   });
});

// Rota GET para consultar um usuário
app.get('/usuario/:id', function(req, res){
   // Recebendo os parâmetros de um query string
   var id = req.params.id;
   // Fazendo uma consulta no banco de dados
   var params = {usuario : {id: id}};
   collection.find(params).toArray(function(err, result){
      res.render('ver', { usuario : result.usuario });
   });
});

// Rota POST para cadastrar um usuário
app.post('/usuario', function(req, res){
   // Recebendo os parâmetros da requisição
   var usuario = req.body.usuario;
   // Persistindo o novo usuário
   collection.insert({usuario : usuario});
   res.redirect('/usuarios');
});

// Rota PUT para atualizar um usuário
app.put('/usuario/:id', function(req, res){
   // Recebendo os parâmetros de um query string
   var id = req.params.id;
   // Recebendo os parâmetros da requisição
   var usuario = req.body.usuario;
   // Atualizando dados do usuário que possuir este id
   collection.update({usuario: {id: id }}, {usuario : usuario});
       res.redirect('/usuarios');
   });

// Rota DELETE para excluir um usuário
app.del('/usuario/:id', function(req, res){
   // Recebendo os parâmetros de um query string
   var id = req.params.id;
   // Excluindo o usuário do banco de dados
   collection.remove({usuario : {id: id }});
   res.redirect('/usuarios');
});
{% endhighlight %}
   <p>Na prática este simples código já exemplifica o poder que <strong>Node.js + MongoDB + Express</strong> pode fazer.</p>
   <p>Para conhecer em mais detalhes essas tecnologias visite:</p>
   <ul>
      <li><strong>Site Oficial do MongoDB:</strong>&nbsp;<a href="http://www.mongodb.org/" title="Site Oficial do MongoDB" target="_blank">http://www.mongodb.org/</a></li>
      <li><strong>Site Oficial do Node.js:</strong>&nbsp;<a href="http://nodejs.org/" title="Site oficial do Node.js" target="_blank">http://nodejs.org/</a></li>
      <li><strong>Site Oficial do Express:</strong>&nbsp;<a href="http://expressjs.com/" title="Site Oficial do Web Framework Express" target="_blank">http://expressjs.com/</a></li>
      <li><strong>Github do MongoQ:</strong>&nbsp;<a href="https://github.com/zzdhidden/mongoq" title="Github do MongoQ" target="_blank">https://github.com/zzdhidden/mongoq</a></li>
   </ul>
   <p>Por enquanto é isso pessoal, espero que tenham gostado dessa e em breve publicarei novas descobertas dessa incrível tecnologia que ando estudando ultimamente.</p>
</div>
