---
layout: post
title: Deploying Meteor no Heroku
tags: Meteor
keywords: Meteor, Heroku
published: true
description: Veja nesse quick post como configurar um servidor Meteor no PaaS Heroku.
image_url: heroku.jpg
---
<figure class="post-image">
  <img src="{{ site.url }}/images/heroku.jpg" width="180" height="58" alt="Deploying Meteor no Heroku" title="Deploying Meteor no Heroku">
  <figcaption>Deploying Meteor no Heroku</figcaption>
</figure>
<div class="post-content">
  <p>
    Recentemente, a equipe do Meteor, publicou em sua newsletter que vai descontinuar os servidores free que são fornecidos através do comando meteor deploy.<br />
    Com isso, acabei migrando alguns dos meus pequenos projetos para o Heroku, e com isso resolvi criar esse post explicando passo-a-passo como fazer deploy para o Heroku.
  </p>

  <h3>Setup do Heroku</h3>
  <p>
    Em primeiro lugar, crie uma conta no <a href="https://heroku.com" target="_blank">heroku.com</a> e em seguida instale seu CLI (veja nesse link <a href="https://toolbelt.heroku.com" target="_blank">toolbelt.heroku.com</a>) para liberar o comando heroku em seu terminal.
  </p>

  <h3>Setup da aplicação</h3>
  <p>
    Agora com o ambiente heroku configurado em sua máquina, execute o comando:
  </p>

{% highlight bash %}
heroku create nome-da-aplicacao
{% endhighlight %}

  <p>
    Em seguida, instale o buildpack do Meteor para configurar os scripts de deploy necessários para uma aplicação Meteor compilar e gerar uma versão Node.js pronta para os servidores do Heroku, para isso, rode o comando:
  </p>

{% highlight bash %}
heroku buildpacks:set https://github.com/AdmitHub/meteor-buildpack-horse.git
{% endhighlight %}

  <p>
    Agora, instale o MongoLabs, que é um serviço PaaS para o MongoDB, ele tem uma versão free que oferece até <strong>500MB de persistência de dados</strong>, para isso rode o comando:
  </p>

{% highlight bash %}
heroku addons:create mongolab
{% endhighlight %}

  <p>
    Para finalizar a configuração do ambiente, configure a variável de ambiente ROOT_URL com o endereço da sua aplicação heroku:
  </p>

{% highlight bash %}
heroku config:set ROOT_URL=https://nome-da-aplicacao.herokuapp.com
{% endhighlight %}

  <p>
    <strong>Obs.:</strong> O Heroku já fornece suporte gratuito ao protocolo HTTPS.
  </p>

  <h3>Configuração extra</h3>
  <p>
    Como dica adicional, caso no futuro você tenha a necessidade de incluir novos dynos, que são servidores dentro do load balancer do Heroku, você provavelmente sofrerá um problema de sua aplicação Meteor não garantir sessão correta entre usuários, para resolver esse problema de <strong>sticky session</strong>, você pode instalar esse plugin adicional gratuitamente:
  </p>

{% highlight bash %}
heroku labs:enable http-session-affinity
{% endhighlight %}

  <h3>Deploying</h3>
  <p>
    Para realizar o primeiro deploy do seu projeto para o Heroku, basta fazer um <strong>git push</strong> no <strong>remote heroku</strong>, que foi configurado automaticamente quando você criou uma aplicação pelo comando <strong>heroku create</strong>, ou seja, rode o comando:
  </p>

{% highlight bash %}
git push heroku master
{% endhighlight %}

  <p>
    <strong>Pronto! Servidor configurado e ready for production.</strong>
  </p>

  <h3>Referências</h3>
  <ul>
    <li>
      <a href="http://justmeteor.com/blog/deploy-to-production-on-heroku" target="_blank">Meteor.js - Deploy to production on Heroku</a>
    </li>
  </ul>
</div>
